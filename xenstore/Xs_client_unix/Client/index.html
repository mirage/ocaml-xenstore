<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Client (xenstore.Xs_client_unix.Client)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../index.html">xenstore</a> &#x00BB; <a href="../index.html">Xs_client_unix</a> &#x00BB; Client</nav><header class="odoc-preamble"><h1>Module <code><span>Xs_client_unix.Client</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#parameters">Parameters</a></li><li><a href="#signature">Signature</a></li></ul></nav><div class="odoc-content"><h2 id="parameters"><a href="#parameters" class="anchor"></a>Parameters</h2><div class="odoc-spec"><div class="spec parameter" id="argument-1-IO" class="anchored"><a href="#argument-1-IO" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="argument-1-IO/index.html">IO</a></span><span> : <a href="../module-type-IO/index.html">IO</a></span></code></div></div><h2 id="signature"><a href="#signature" class="anchor"></a>Signature</h2><div class="odoc-spec"><div class="spec type" id="type-client" class="anchored"><a href="#type-client" class="anchor"></a><code><span><span class="keyword">type</span> client</span></code></div><div class="spec-doc"><p>A multiplexing xenstore client.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_logger" class="anchored"><a href="#val-set_logger" class="anchor"></a><code><span><span class="keyword">val</span> set_logger : <span><span>( <span>string <span class="arrow">&#45;&gt;</span></span> unit )</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p>Set a callback in order to get logging from the library</p></div></div><div class="odoc-spec"><div class="spec value" id="val-make" class="anchored"><a href="#val-make" class="anchor"></a><code><span><span class="keyword">val</span> make : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-client">client</a> <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>make ()</code> initialises and returns a xenstore client.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_watch_callback" class="anchored"><a href="#val-set_watch_callback" class="anchor"></a><code><span><span class="keyword">val</span> set_watch_callback : <span><a href="#type-client">client</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-watch_callback">watch_callback</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>set_watch_callback cb</code> registers a manual watch callback.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-handle" class="anchored"><a href="#type-handle" class="anchor"></a><code><span><span class="keyword">type</span> handle</span></code></div><div class="spec-doc"><p>A handle represents a single thread's xenstore access.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-immediate" class="anchored"><a href="#val-immediate" class="anchor"></a><code><span><span class="keyword">val</span> immediate : <span><a href="#type-client">client</a> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="argument-1-IO/index.html#type-t">IO.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p>Access xenstore with individual operations.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-transaction_one_try" class="anchored"><a href="#val-transaction_one_try" class="anchor"></a><code><span><span class="keyword">val</span> transaction_one_try : <span><a href="#type-client">client</a> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="argument-1-IO/index.html#type-t">IO.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p>Access xenstore with a single transaction. On conflict the Eagain error will not be handled but will be passed up to the caller.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-transaction_attempts" class="anchored"><a href="#val-transaction_attempts" class="anchor"></a><code><span><span class="keyword">val</span> transaction_attempts : <span>int <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-client">client</a> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="argument-1-IO/index.html#type-t">IO.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p>Access xenstore with a single transaction. On conflict the operation may be attempted again, up to a total of (max attempts 1) attempts. If the last of those fails with a conflict, the Eagain exception will be raised to the caller.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-transaction" class="anchored"><a href="#val-transaction" class="anchor"></a><code><span><span class="keyword">val</span> transaction : <span><a href="#type-client">client</a> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="argument-1-IO/index.html#type-t">IO.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p>DEPRECATED! Access xenstore with a single transaction. On conflict the operation will be repeated INDEFINITELY, with no guarantee of eventual success or termination.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-wait" class="anchored"><a href="#val-wait" class="anchor"></a><code><span><span class="keyword">val</span> wait : <span><a href="#type-client">client</a> <span class="arrow">&#45;&gt;</span></span> <span><span>( <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="argument-1-IO/index.html#type-t">IO.t</a></span> )</span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="../Task/index.html#type-u">Task.u</a></span></span></code></div><div class="spec-doc"><p>Wait for some condition to become true and return a value. The function argument should throw Eagain if the condition is not met, and the condition will be re-evaluated when paths change.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-directory" class="anchored"><a href="#val-directory" class="anchor"></a><code><span><span class="keyword">val</span> directory : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>directory h path</code> returns the directory listing of <code>path</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-read" class="anchored"><a href="#val-read" class="anchor"></a><code><span><span class="keyword">val</span> read : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>read h path</code> returns the value at <code>path</code> or raises Enoent.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-write" class="anchored"><a href="#val-write" class="anchor"></a><code><span><span class="keyword">val</span> write : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>write h k v</code> writes <code>v</code> at <code>k</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-rm" class="anchored"><a href="#val-rm" class="anchor"></a><code><span><span class="keyword">val</span> rm : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>rm h k</code> removes the node <code>k</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-mkdir" class="anchored"><a href="#val-mkdir" class="anchor"></a><code><span><span class="keyword">val</span> mkdir : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>mkdir h k</code> creates the node <code>k</code> with an empty value.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-setperms" class="anchored"><a href="#val-setperms" class="anchor"></a><code><span><span class="keyword">val</span> setperms : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Xs_protocol/ACL/index.html#type-t">Xs_protocol.ACL.t</a> <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>setperms h k acl</code> sets the permissions of <code>k</code> to <code>acl</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-debug" class="anchored"><a href="#val-debug" class="anchor"></a><code><span><span class="keyword">val</span> debug : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <span class="arrow">&#45;&gt;</span></span> <span><span>string list</span> <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>debug cmd_args</code> invokes a debug command.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-restrict" class="anchored"><a href="#val-restrict" class="anchor"></a><code><span><span class="keyword">val</span> restrict : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>restrict h domid</code> restricts the current connection to have only the priviledges associated with domain <code>domid</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-getdomainpath" class="anchored"><a href="#val-getdomainpath" class="anchor"></a><code><span><span class="keyword">val</span> getdomainpath : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>string <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>getdomainpath domid</code> returns the local directory of domain <code>domid</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-watch" class="anchored"><a href="#val-watch" class="anchor"></a><code><span><span class="keyword">val</span> watch : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>watch h path token</code> registers a manual watch at <code>path</code> with <code>token</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-unwatch" class="anchored"><a href="#val-unwatch" class="anchor"></a><code><span><span class="keyword">val</span> unwatch : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>unwatch h path token</code> unregisters a manual watch at <code>path</code> with <code>token</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-introduce" class="anchored"><a href="#val-introduce" class="anchor"></a><code><span><span class="keyword">val</span> introduce : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>nativeint <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>introduce h domid store_mfn store_port</code> called by a toolstack to signal the construction of a new domain.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_target" class="anchored"><a href="#val-set_target" class="anchor"></a><code><span><span class="keyword">val</span> set_target : <span><a href="#type-handle">handle</a> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>unit <a href="argument-1-IO/index.html#type-t">IO.t</a></span></span></code></div><div class="spec-doc"><p><code>set_target h stubdom_domid domid</code> called by a toolstack to grant <code>stubdom_domid</code> the permissions owned by <code>domid</code>.</p></div></div></div></body></html>